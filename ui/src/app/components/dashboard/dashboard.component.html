<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <button mat-raised-button color="primary" (click)="refreshData()" [disabled]="loading">
      <mat-icon>refresh</mat-icon>
      Refresh
    </button>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-message">
    <mat-icon>error</mat-icon>
    {{error}}
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error" class="dashboard-content">
    
    <!-- Stats Cards -->
    <div class="stats-grid">
      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon color="primary">people</mat-icon>
            </div>
            <div class="stat-details">
              <h2>{{totalUsers}}</h2>
              <p>Total Users</p>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon color="accent">analytics</mat-icon>
            </div>
            <div class="stat-details">
              <h2>{{totalEvents}}</h2>
              <p>Total Events</p>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon color="warn">notifications</mat-icon>
            </div>
            <div class="stat-details">
              <h2>{{totalNotifications}}</h2>
              <p>Notifications Sent</p>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon">
              <mat-icon style="color: #4caf50;">person</mat-icon>
            </div>
            <div class="stat-details">
              <h2>{{uniqueUsers}}</h2>
              <p>Active Users</p>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Charts Section -->
    <div class="charts-grid">
      
      <!-- Event Distribution Chart -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Event Distribution</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas baseChart
                    [data]="eventChartData"
                    [options]="doughnutChartOptions"
                    type="doughnut">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Device Usage Chart -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Device Usage</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas baseChart
                    [data]="deviceChartData"
                    [options]="barChartOptions"
                    type="bar">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Hourly Activity Chart -->
      <mat-card class="chart-card full-width">
        <mat-card-header>
          <mat-card-title>Hourly Activity (Last 24 Hours)</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas baseChart
                    [data]="hourlyChartData"
                    [options]="lineChartOptions"
                    type="line">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Quick Actions</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="action-buttons">
            <button mat-raised-button 
                    color="primary" 
                    routerLink="/users"
                    (click)="trackEvent('navigate_to_users')">
              <mat-icon>people</mat-icon>
              Manage Users
            </button>
            
            <button mat-raised-button 
                    color="accent" 
                    routerLink="/notifications"
                    (click)="trackEvent('navigate_to_notifications')">
              <mat-icon>notifications</mat-icon>
              Send Notification
            </button>
            
            <button mat-raised-button 
                    color="warn" 
                    routerLink="/analytics"
                    (click)="trackEvent('navigate_to_analytics')">
              <mat-icon>analytics</mat-icon>
              View Analytics
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
